<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Powershell</title>
</head>
<body style="text-align: center; background-color: black;">

    <div>

        <h1 style="font-family: 'Times New Roman', Times, serif; text-align: center; color: white;">POWERSHELL</h1>

    </div>

    <div>

        <h3 style="font-family: 'Times New Roman', Times, serif; text-align: center; color: white;">Creaci√≥n de Usuarios</h3>

    </div>

    
    <iframe
        src="https://carbon.now.sh/embed?bg=rgba%280%2C0%2C0%2C1%29&t=3024-night&wt=none&l=powershell&width=680&ds=false&dsyoff=0px&dsblur=0px&wc=false&wa=true&pv=0px&ph=0px&ln=false&fl=1&fm=Hack&fs=13.5px&lh=122%25&si=false&es=2x&wm=false&code=%2523%2520Definimos%2520los%2520par%25C3%25A1metros%250Aparam%28%250A%2520%2520%2520%2520%255BParameter%28Mandatory%253D%2524true%29%255D%250A%2520%2520%2520%2520%255Bstring%255D%2524UserName%252C%250A%250A%2520%2520%2520%2520%255BParameter%28Mandatory%253D%2524true%29%255D%250A%2520%2520%2520%2520%255Bstring%255D%2524EmailAddress%252C%250A%250A%2520%2520%2520%2520%255BParameter%28Mandatory%253D%2524true%29%255D%250A%2520%2520%2520%2520%255Bstring%255D%2524Department%252C%250A%250A%2520%2520%2520%2520%255BParameter%28Mandatory%253D%2524true%29%255D%250A%2520%2520%2520%2520%255Bstring%255D%2524JobTitle%252C%250A%250A%2520%2520%2520%2520%255BParameter%28Mandatory%253D%2524true%29%255D%250A%2520%2520%2520%2520%255BSecureString%255D%2524Password%250A%29%250A%250A%2523%2520Validamos%2520los%2520par%25C3%25A1metros%250Aif%2520%28-not%2520%28%2524UserName%2520-and%2520%2524EmailAddress%2520-and%2520%2524Department%2520-and%2520%2524JobTitle%2520-and%2520%2524Password%29%29%2520%257B%250A%2520%2520%2520%2520throw%2520%2522Faltan%2520los%2520par%25C3%25A1metros%2520de%2520entrada%2520requeridos%2522%250A%257D%250A%250A%2523%2520Validamos%2520la%2520contrase%25C3%25B1a%250A%2524passwordString%2520%253D%2520%255BSystem.Runtime.InteropServices.Marshal%255D%253A%253APtrToStringAuto%28%255BSystem.Runtime.InteropServices.Marshal%255D%253A%253ASecureStringToBSTR%28%2524Password%29%29%250A%2524isValidPassword%2520%253D%2520%2524false%250Aif%2520%28%2524passwordString%2520-match%2520%2522%255E%28%253F%253D.*%255Ba-z%255D%29%28%253F%253D.*%255BA-Z%255D%29%28%253F%253D.*%255Cd%29%28%253F%253D.*%255B%255E%255Cda-zA-Z%255D%29.%257B8%252C%257D%2524%2522%29%2520%257B%250A%2520%2520%2520%2520%2524isValidPassword%2520%253D%2520%2524true%250A%257D%250A%250Aif%2520%28-not%2520%2524isValidPassword%29%2520%257B%250A%2520%2520%2520%2520Write-Host%2520%2522La%2520contrase%25C3%25B1a%2520no%2520es%2520v%25C3%25A1lida.%2520Debe%2520contener%2520al%2520menos%25208%2520caracteres%252C%2520incluyendo%2520may%25C3%25BAsculas%252C%2520min%25C3%25BAsculas%252C%2520n%25C3%25BAmeros%2520y%2520caracteres%2520especiales%2522%250A%2520%2520%2520%2520return%250A%257D%250A%250A%2523%2520Generamos%2520una%2520contrase%25C3%25B1a%2520segura%250A%2524securePassword%2520%253D%2520ConvertTo-SecureString%2520-String%2520%2524passwordString%2520-AsPlainText%2520-Force"
        style="width: 1100px; height: 700px; border:0; transform: scale(1); overflow:hidden;"
        sandbox="allow-scripts allow-same-origin">
    </iframe>

    <iframe
        src="https://carbon.now.sh/embed?bg=rgba%280%2C0%2C0%2C1%29&t=3024-night&wt=none&l=powershell&width=680&ds=false&dsyoff=0px&dsblur=0px&wc=false&wa=true&pv=0px&ph=0px&ln=false&fl=1&fm=Hack&fs=13.5px&lh=122%25&si=false&es=2x&wm=false&code=%2523%2520Creamos%2520un%2520nuevo%2520usuario%2520en%2520Active%2520Directory%250Atry%2520%257B%250ANew-ADUser%2520-Name%2520%2524UserName%2520-SamAccountName%2520%2524UserName%2520-UserPrincipalName%2520%2522%2524UserName%2540yourdomain.com%2522%2520-EmailAddress%2520%2524EmailAddress%2520-Department%2520%2524Department%2520-Title%2520%2524JobTitle%2520%250A-AccountPassword%2520%2524securePassword%2520-Enabled%2520%2524true%250A%257D%2520catch%2520%257B%250AWrite-Host%2520%2522No%2520se%2520pudo%2520crear%2520la%2520cuenta%2520de%2520usuario%2520debido%2520al%2520siguiente%2520error%253A%2520%2524%2522%250A%257D%250A%250A%2523%2520A%25C3%25B1adimos%2520al%2520usuario%2520a%2520su%2520respectivo%2520grupo%2520y%2520departamento%250A%2524groupNames%2520%253D%2520%2540%28%29%250Aif%2520%28%2524Department%2520-eq%2520%2522Sales%2522%29%2520%257B%250A%2524groupNames%2520%252B%253D%2520%2522Sales%2520Group%2522%250A%257D%2520elseif%2520%28%2524Department%2520-eq%2520%2522Marketing%2522%29%2520%257B%250A%2524groupNames%2520%252B%253D%2520%2522Marketing%2520Group%2522%250A%257D%250A%250Aif%2520%28%2524JobTitle%2520-eq%2520%2522Manager%2522%29%2520%257B%250A%2524groupNames%2520%252B%253D%2520%2522Managers%2520Group%2522%250A%257D%250A%250Aforeach%2520%28%2524groupName%2520in%2520%2524groupNames%29%2520%257B%250AAdd-ADGroupMember%2520-Identity%2520%2524groupName%2520-Members%2520%2524UserName%250A%257D%250A%250AWrite-Host%2520%2522El%2520usuario%2520%2524UserName%2520ha%2520sido%2520creado%2520correctamente%2522"
        style="width: 1100px; height: 500px; border:0; transform: scale(1); overflow:hidden;"
        sandbox="allow-scripts allow-same-origin">
    </iframe>

    <div>

        <h3 style="font-family: 'Times New Roman', Times, serif; text-align: center; color: white;">Borrado de Usuarios</h3>

    </div>

    <iframe
        src="https://carbon.now.sh/embed?bg=rgba%280%2C0%2C0%2C1%29&t=3024-night&wt=none&l=powershell&width=680&ds=false&dsyoff=0px&dsblur=0px&wc=false&wa=true&pv=0px&ph=0px&ln=false&fl=1&fm=Hack&fs=13.5px&lh=122%25&si=false&es=2x&wm=false&code=%2523%2520Obtener%2520la%2520lista%2520de%2520usuarios%2520existentes%2520en%2520AD%250A%2524users%2520%253D%2520Get-ADUser%2520-Filter%2520*%250A%250A%2523%2520Mostrar%2520la%2520lista%2520de%2520usuarios%2520con%2520un%2520n%25C3%25BAmero%2520de%2520%25C3%25ADndice%250Afor%2520%28%2524i%253D0%253B%2520%2524i%2520-lt%2520%2524users.Count%253B%2520%2524i%252B%252B%29%2520%257B%250A%2520%2520%2520%2520Write-Host%2520%2522%2524i.%2520%2524%28%2524users%255B%2524i%255D.Name%29%2522%250A%257D%250A%250A%2523%2520Pedir%2520al%2520usuario%2520que%2520seleccione%2520un%2520usuario%2520para%2520eliminar%250A%2524userIndex%2520%253D%2520Read-Host%2520%2522Seleccione%2520un%2520usuario%2520para%2520eliminar%2520ingresando%2520su%2520n%25C3%25BAmero%2520de%2520%25C3%25ADndice%253A%2522%250A%250A%2523%2520Obtener%2520el%2520usuario%2520seleccionado%250A%2524selectedUser%2520%253D%2520%2524users%255B%2524userIndex%255D%250A%250A%2523%2520Solicitar%2520confirmaci%25C3%25B3n%2520para%2520eliminar%2520el%2520usuario%250A%2524confirm%2520%253D%2520Read-Host%2520%2522%25C2%25BFEst%25C3%25A1%2520seguro%2520que%2520desea%2520eliminar%2520%2524%28%2524selectedUser.Name%29%253F%2520%28S%252FN%29%2522%250A%250Aif%2520%28%2524confirm.ToLower%28%29%2520-eq%2520%2522s%2522%29%2520%257B%250A%2520%2520%2520%2520%250A%2520%2520%2520%250A%2520%2520%2520%2520%2523%2520Eliminar%2520el%2520usuario%2520seleccionado%250A%2520%2520%2520%2520Remove-ADUser%2520-Identity%2520%2524selectedUser%2520-Confirm%253A%2524false%250A%2520%2520%2520%2520Write-Host%2520%2522El%2520usuario%2520%2524%28%2524selectedUser.Name%29%2520ha%2520sido%2520eliminado%2520correctamente.%2522%250A%257D%2520else%2520%257B%250A%2520%2520%2520%2520Write-Host%2520%2522La%2520eliminaci%25C3%25B3n%2520del%2520usuario%2520%2524%28%2524selectedUser.Name%29%2520ha%2520sido%2520cancelada.%2522%250A%257D%250A"
        style="width: 800px; height: 500px; border:0; transform: scale(1); overflow:hidden;"
        sandbox="allow-scripts allow-same-origin">
    </iframe>
            

</body>
</html>